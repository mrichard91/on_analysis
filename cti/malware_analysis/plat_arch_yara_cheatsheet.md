# Platform and Architecture Yara Cheatsheet
This is a reference for some notable features of platforms and architectures that are relevant when writing yara signatures. This serves as a reference when writing YARA signatures but also as context for LLM prompts that need specific context to review rules and make suggestions.

## Languages
### Golang
**Unique attributes**
* By default binaries are statically linked with standard libraries and dependencies, making them large with a lot of shared code and structure. Min size ~2MB.
* Golang strings are stored in the binary data section (.rdata on PE), are stacked continuously with no delimiter ("foo" and "bar" are "foobar")
* byte[] are frequently used in code sections (.text on PE) using `mov reg, imm` syntax making them more difficult to reliably signature cross-arch as x86 takes 16/32/64 bit imm, but ARM takes only 16-bits non-aligned to byte boundaries
* In default setup golang can cross-compile 45+ arch/platform combinations making it easy and effective for authors

**Yara Tips**
* Avoid using fullword due to non-terminated strings storage
* Package strings work across plat/arch builds, i.e. "main.main.func1" and are unique
* Third party packages can be used to identify library usage such as "github.com/nknorg/nkn/", this is like imports for other runtimes like PE
* Binary tokens that match on code are unlikely to match cross-arch

**Reference/tools**
* [Cross platform detection testing](https://github.com/mrichard91/go_yara_detection)
* [Golang Detection Notes](golang_detection.md)

